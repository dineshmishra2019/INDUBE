{% extends 'base.html' %}

{% block title %}
  {% if current_category %}{{ current_category.name }} Feed{% else %}Public Feed{% endif %}
{% endblock %}

{% block content %}
  <h2>
    {% if current_category %}{{ current_category.name }}{% else %}Public Media Feed{% endif %}
  </h2>

  <div style="margin-bottom: 1.5em; padding-bottom: 1em; border-bottom: 1px solid #ddd;">
    <strong>Categories:</strong>
    <a href="{% url 'home' %}" style="margin-left: 1em; {% if not current_category %}font-weight: bold;{% endif %}">All</a>
    {% for category in categories %}
      <a href="{% url 'home_by_category' category.slug %}" style="margin-left: 1em; {% if current_category == category %}font-weight: bold;{% endif %}">{{ category.name }}</a>
    {% endfor %}
  </div>

  <div class="media-grid">
    {% for item in media_items %}
      <div class="media-item">
        <a href="{% url 'media_detail' item.pk %}">
          <h3>{{ item.title }}</h3>
        </a>
        <p>By: {{ item.owner.username }}</p>
        {% if item.is_image %}
          <img src="{{ item.file.url }}" alt="{{ item.title }}">
        {% else %}
          <video controls width="250"><source src="{{ item.file.url }}"></video>
        {% endif %}
      </div>
    {% empty %}
      <p>No public media has been uploaded yet.</p>
    {% endfor %}
  </div>
{% endblock %}